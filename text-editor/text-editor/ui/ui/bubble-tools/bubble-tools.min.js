/*!
 * ==========================================================
 *  BUBBLE TOOLS PLUGIN FOR USER INTERFACE MODULE 1.0.10
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.each(function(E){function y(E,T,A){L.tools[E].click(null,A);for(B in T)(g=C("[name=data]",r)[0])&&(g.value=T[B],(b=C("[name=y]",r)[0])&&G.fire("click",b))}function x(I,R,i){p=T.languages.tools[R],B=e[R],I=B&&B.i||R,h="|"===R,m=f(h?"span":"a",h?!1:-1!==I.indexOf("<")?I:L.i(R,B.i),h?{"class":A+"-separator"}:{"class":A+"-button",href:"javascript:;",title:"object"==typeof p?p[0]+(p[1]?" ("+p[1]+")":""):p,data:{"tool-id":R}}),G.set("keydown",m,function(T){if(g=this,b=T.TE.key,v=E.$(),b("down"))return E.select(v.end+("\n"===v.after[0]?1:0)),G.x(T);if(b(["up","escape"]))return E.select(),G.x(T);if(b("right")&&(Y=u(g))){for(;!l(Y,"a")&&Y;)Y=u(Y);Y.focus()}else if(b("left")&&(Y=s(g))){for(;!l(Y,"a")&&Y;)Y=s(Y);Y.focus()}}),G.set("click",m,function(T){return B=S(this,"tool-id"),e[B].click(T,E,B),(b=C("[name=data]",r)[0])&&L.bubble(t,function(T){N(T,{"font-size":"80%"}),v=b.value,Y=f("input",!1,{type:"text",value:v,placeholder:v,"class":A+"-input",spellcheck:"false"}),G.set("keydown",Y,function(T){return b=T.TE.key,v=this.value,b("escape")||b(["back","enter"])&&!v?(L.bubble.exit(1),G.x(T)):b("enter")?(y(B,[v,"",""],E),G.x(T)):void 0}),a(T,Y),U(function(){Y.focus(),Y.select()})}),d(),G.x(T)}),a(i,m)}var I,D,W,p,K,h,m,B,g,b,v,Y,T=E.config,A=T.classes[""],L=E.ui,e=L.tools,R=["b i a img pre,code","p blockquote,q p,h1,h2,h3,h4,h5,h6 ul ol hr"],t="tool "+A+"-tool",r=L.el.modal,i=L.el.bubble,O=E.target,n=E._,N=n.css,o=n.dom,a=o.append,S=o.data.get,C=o.get,l=o.is,u=o.next,s=o.previous,f=(n.edge,n.el),G=n.events,M=n.extend,P=(n.format,n.hooks),U=n.timer.set,F=n.trim,d=function(){U(function(){L.bubble.fit()})};T.tools_alt&&(G.set("keydown",O,function(T){return b=T.TE.key,v=!T.TE.shift()&&C(i)[0],Y=E.$(),v&&b("up")?(E.select(Y.start-("\n"===Y.before.slice(-1)?1:0)),G.x(T)):v&&b("down")?(C("a",i)[0].focus(),G.x(T)):void 0}),G.set("copy cut keyup mouseup paste scroll",O,function(A){b=E.$(),D=E.get(0)&&/(^|\n)$/.test(b.before)&&/(\n|$)$/.test(b.after),b.length||D?L.bubble(t,function(E){N(E,{padding:0,"font-size":"80%"}),I=T.tools_alt,I=I===!0?R:I,I="string"==typeof I?[I,I]:M(I,R),W=F(I[D?1:0]).split(/\s+/);for(g in W)g=W[g],(K=e[g])&&x(K,g,E)}):L.bubble.exit()}),P.set("enter.bubble",d))});